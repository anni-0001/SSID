# ^^^^^^^^^^^^^^^^^^^^^^^^
# ubuntu Dockerfile
FROM ubuntu

RUN apt update && apt install  openssh-server sudo sshpass tcpdump vim tmux net-tools -y
RUN echo 'root:password' | chpasswd
# RUN echo 'test:test' | chpasswd
RUN service ssh start
RUN mkdir ~/.ssh
# RUN mkdir ~/.ssh/HII

RUN chmod 700 ~/.ssh
RUN sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/g' /etc/ssh/sshd_config
# RUN sed -i 's/#PasswordAuthentication no/PasswordAuthentication yes/g' /etc/ssh/sshd_config
RUN sed -i 's/#PermitEmptyPasswords no/PermitEmptyPasswords yes/g' /etc/ssh/sshd_config
RUN echo 'PubkeyAuthentication yes' >> /etc/ssh/sshd_config
RUN touch ~/.ssh/authorized_keys
# RUN chmod 600 ~/.ssh/authorized_keys
COPY config /root/.ssh/
RUN chmod 600 ~/.ssh/config
# RUN sed -i 's/#PermitEmptyPassworPermitEmptyPasswords yes/g' /etc/ssh/sshd_config
# RUN echo 'StrictHostKeyChecking'
# RUN ["/bin/bash", "-c","ssh-keygen -t rsa -N '' -f ~/.ssh/id_rsa <<< y"]
# RUN chmod 600 ~/.ssh/id_rsa 
RUN service ssh restart

COPY tcpconf.sh /usr/local/sbin/
RUN chmod +x /usr/local/sbin/tcpconf.sh
RUN echo 'test' > password.txt | chmod 600 password.txt
EXPOSE 22
# testing ssh: key gen using same volumes
# RUN mkdir -p /home/test/.ssh
# COPY id_rsa_shared /home/test/.ssh/id_rsa
# RUN mkdir /home/test/.ssh/known_hosts


# RUN ssh-keygen -t rsa -N '' -f ~/.ssh/id_rsa <<< y
# RUN [/bin/bash ssh-keygen -t rsa -N '' -f ~/.ssh/id_rsa <<< y]

CMD ["/usr/local/sbin/tcpconf.sh"]
# CMD [sleep 100]

# commands to enter to activate:
# create the containers
    # docker build -t <imagetype> .
    # docker build -t ubuntu .

    # docker run -dit --name <given name> -p <hostport>:<containerport> <image type>
    # docker run -dit --name ssid-dev3 -p 2003:22 ubuntu


# ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
# alpline Dockerfile 


# RUN \
#   apk update && \
#   apk add openrc --no-cache && \
#   apk add openssh-server && \
#   rc-update add sshd && \
#   rc-status && \
#   touch /run/openrc/softlevel 

# Expose port for ssh
# EXPOSE 22

# Start SSH Service
# CMD ["sh" , "-c", "service sshd restart && sh"]
# RUN mkdir hi